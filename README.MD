ğŸ  **Hub de Controle IoT: Flask + ESP32 (Socket.IO)**

Este projeto implementa um sistema de controle de dispositivos IoT em tempo real, utilizando Flask como servidor web/Hub de comunicaÃ§Ã£o e um ESP32 como o dispositivo de campo para acionamento de relÃ©s. A comunicaÃ§Ã£o bidirecional e de baixa latÃªncia Ã© garantida pelo Socket.IO.

ğŸš€ **Tecnologias Utilizadas**

---
Componente

Linguagem/Plataforma

DependÃªncias Chave

FunÃ§Ã£o Principal

Hub/Backend

Python (Flask)

Flask-SocketIO, python-socketio

Servidor Web, Gerenciamento de Status (Online/Offline) e Roteamento de Comandos.

Frontend/UI

JavaScript, HTML, CSS

Socket.IO Client, Tailwind CSS

Interface de UsuÃ¡rio responsiva e envio/recebimento de comandos em tempo real.

Dispositivo

C++ (Arduino)

WiFiManager, SocketIOClient

ConexÃ£o Wi-Fi portÃ¡til, recebimento de comandos e controle de GPIO (RelÃ©s).
---

ğŸ“ Arquitetura do Sistema

O sistema opera em uma arquitetura centralizada onde o servidor Flask atua como um broker de mensagens em tempo real:

ConexÃ£o: O ESP32 utiliza a biblioteca WiFiManager para se conectar Ã  rede. Em seguida, estabelece uma conexÃ£o persistente de Socket.IO com o Hub Flask.

Status: O Hub Flask monitora a conexÃ£o. Se o ESP32 estiver conectado, o status na interface web Ã© Online.

Comando: O usuÃ¡rio na interface web clica em um botÃ£o (Ligar/Desligar).

Roteamento: O navegador (cliente Socket.IO) envia o comando (web_command) para o Flask.

AÃ§Ã£o: O Flask retransmite o comando diretamente para o ESP32 conectado.

Feedback: O ESP32 aciona o relÃ© e pode opcionalmente enviar uma confirmaÃ§Ã£o de volta ao Flask, que a exibe no log da interface web.

ğŸ› ï¸ ConfiguraÃ§Ã£o do Backend (Flask Hub)

PrÃ©-requisitos

Python 3.x

PIP (Gerenciador de Pacotes Python)

InstalaÃ§Ã£o

Crie um ambiente virtual e instale as dependÃªncias:

# 1. Clonar o repositÃ³rio
git clone <URL_DO_SEU_REPOSITÃ“RIO>
cd <nome-do-diretorio>

# 2. Criar e ativar o ambiente virtual (Exemplo Linux/macOS)
python3 -m venv venv
source venv/bin/activate
# (Para Windows, use: .\venv\Scripts\activate)

# 3. Instalar dependÃªncias
pip install Flask flask-socketio


Estrutura de Arquivos

/
â”œâ”€â”€ app.py              # AplicaÃ§Ã£o Flask principal e lÃ³gica Socket.IO
â”œâ”€â”€ README.md           # Este arquivo
â”œâ”€â”€ requirements.txt    # Lista de dependÃªncias Python
â””â”€â”€ templates/
    â””â”€â”€ index.html      # Frontend HTML
â””â”€â”€ static/
    â”œâ”€â”€ app.js          # LÃ³gica do Socket.IO e UI do cliente
    â””â”€â”€ styles.css      # Estilos customizados


ExecuÃ§Ã£o

Para iniciar o servidor Flask:

python app.py


O Hub estarÃ¡ disponÃ­vel em http://127.0.0.1:5000 (ou na porta configurada).

ğŸ’» ConfiguraÃ§Ã£o do Firmware (ESP32)

PrÃ©-requisitos

Arduino IDE ou VS Code com extensÃ£o PlatformIO.

Placa ESP32 configurada.

Bibliotecas NecessÃ¡rias

Instale as seguintes bibliotecas atravÃ©s do Gerenciador de Bibliotecas da IDE:

WiFiManager (Recomendado: VersÃ£o compatÃ­vel com ESP32, ex: por tzapu ou Tabalabs)

SocketIOClient (Cliente Socket.IO para ESP32)

Portabilidade Wi-Fi

O uso do WiFiManager garante a portabilidade. Na primeira execuÃ§Ã£o, o ESP32 criarÃ¡ um Ponto de Acesso (AP) chamado ESP32_HUB_SETUP.

Conecte-se a esse AP via celular ou computador.

Um portal de configuraÃ§Ã£o abrirÃ¡ automaticamente.

Selecione sua rede Wi-Fi local e insira a senha.

O ESP32 salvarÃ¡ as credenciais e reiniciarÃ¡, conectando-se automaticamente.

LÃ³gica de ConexÃ£o

O firmware deve ser configurado para apontar para o IP do seu servidor Flask (ex: http://192.168.1.10:5000) apÃ³s a conexÃ£o bem-sucedida do WiFiManager.

Eventos Chave no ESP32:

Evento

DireÃ§Ã£o

PropÃ³sito

connect

ESP32 -> Flask

Notifica o Hub que o dispositivo estÃ¡ online.

web_command

Flask -> ESP32

Recebe o JSON de comando ({"target": "lamp", "state": "on"}).

status_update

ESP32 -> Flask

Opcional: Envia confirmaÃ§Ã£o de que o comando foi executado.

ğŸ¤ ContribuiÃ§Ã£o

Sinta-se Ã  vontade para sugerir melhorias, como:

MigraÃ§Ã£o para MQTT para maior robustez em ambientes de alta latÃªncia.

ImplementaÃ§Ã£o de um banco de dados para persistÃªncia do estado (ex: Firestore ou SQLite).

AutenticaÃ§Ã£o de usuÃ¡rios na interface web.