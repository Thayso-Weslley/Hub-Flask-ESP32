<!DOCTYPE html>
<html lang="pt-br">
<head>
    <title>Hub de Controle ESP32 - Socket.IO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Biblioteca Socket.IO do cliente -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.4/socket.io.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Corrigindo o caminho do CSS para a estrutura padrão do Flask -->
    <!-- (Flask procura 'static/css/style.css' e não '../static/css/style.css') -->
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body class="p-4 md:p-8 min-h-screen">
    <div class="max-w-xl mx-auto rounded-xl main-card p-6 md:p-8">
        
        <!-- Cabeçalho (com usuário logado, vindo do app.py) -->
        <div class="flex justify-between items-center mb-6">
            <div>
                <h1 class="text-3xl font-extrabold text-gray-900 mb-1">Hub de Controle IoT</h1>
                <p class="text-gray-600">Olá, <span class="font-semibold">{{ username }}</span>!</p>
            </div>
            <a href="{{ url_for('logout') }}" class="text-sm font-medium text-blue-600 hover:text-blue-800">Sair</a>
        </div>

        <!-- 
          CONTÊINER DINÂMICO 
          O JavaScript (main.js) irá preencher esta seção com os bloquinhos
          ou com a mensagem "Nenhum microcontrolador encontrado...".
        -->
        <section id="dashboard-container" class="flex flex-col gap-6">
            <!-- Os bloquinhos .ESP-container serão inseridos aqui -->
        </section>
        
        <!-- Log -->
        <div class="mt-8">
            <h2 class="text-xl font-bold text-gray-800 mb-2 border-b pb-2">Log do Hub (Cliente Web)</h2>
            <div id="log-container" class="p-3 h-40 overflow-y-auto rounded-lg resize-y border border-gray-300">
                <p>Aguardando conexão...</p>
            </div>
        </div>
    </div>

    <!-- 
      Variável 'initialStatus' removida, pois não é mais necessária.
      O JavaScript agora obtém o status do evento 'full_device_update'.
    -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>